<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8fd1faf6fd93e4e6d207ae0f9db51d78.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot normal curves for of height counts for men and women separately and together</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example from https://avehtari.github.io/ROS-Examples/CentralLimitTheorem/heightweight.html</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>heights <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">height=</span><span class="dv">54</span><span class="sc">:</span><span class="dv">75</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">female=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">107</span>,<span class="dv">296</span>,<span class="dv">695</span>,<span class="dv">1612</span>,<span class="dv">2680</span>,<span class="dv">4645</span>,<span class="dv">8201</span>,<span class="dv">9948</span>,<span class="dv">11733</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">10270</span>,<span class="dv">9942</span>,<span class="dv">6181</span>,<span class="dv">3990</span>,<span class="dv">2131</span>,<span class="dv">1154</span>,<span class="dv">245</span>,<span class="dv">257</span>,<span class="dv">0</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)<span class="sc">*</span><span class="dv">10339</span><span class="sc">/</span><span class="dv">74167</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">male=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">542</span>,<span class="dv">668</span>,<span class="dv">1221</span>,<span class="dv">2175</span>,<span class="dv">4213</span>,<span class="dv">5535</span>,<span class="dv">7980</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">9566</span>,<span class="dv">9578</span>,<span class="dv">8867</span>,<span class="dv">6716</span>,<span class="dv">5019</span>,<span class="dv">2745</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">1464</span>,<span class="dv">1263</span>)<span class="sc">*</span><span class="dv">9983</span><span class="sc">/</span><span class="dv">67552</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(female, male), <span class="at">names_to=</span><span class="st">"sex"</span>, <span class="at">values_to=</span><span class="st">"count"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>heights_f <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">"female"</span>), <span class="fu">aes</span>(<span class="at">x=</span>height, <span class="at">y=</span>count)) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) <span class="fl">1e4</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="fl">63.7</span>, <span class="fl">2.7</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"orange"</span>, <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">53</span>, <span class="dv">83</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1700</span>) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Heights of female adults (US)"</span>) <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>heights_m <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">"male"</span>), <span class="fu">aes</span>(<span class="at">x=</span>height, <span class="at">y=</span>count)) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) <span class="fl">1e4</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="fl">69.1</span>, <span class="fl">2.9</span>),</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"orange"</span>, <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span>  </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">53</span>, <span class="dv">83</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1700</span>) <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Heights of male adults (US)"</span>) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>heights_adults <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heights, <span class="fu">aes</span>(<span class="at">x=</span>height, <span class="at">y=</span>count)) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) <span class="fl">2.1e4</span> <span class="sc">*</span> (<span class="fl">0.52</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="fl">63.7</span>, <span class="fl">2.7</span>) <span class="sc">+</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                                       <span class="fl">0.48</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="fl">69.1</span>, <span class="fl">2.9</span>)),</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"orange"</span>, <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">53</span>, <span class="dv">83</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">2100</span>) <span class="sc">+</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Heights of all adults (US)"</span>) <span class="sc">+</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Example binomial and poisson distributions</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co"># A data frame of values 1:20, with some binomial and poisson distributed values</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>bin_pois_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">count=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pois1=</span><span class="fu">dpois</span>(count, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pois4=</span><span class="fu">dpois</span>(count, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pois10=</span><span class="fu">dpois</span>(count, <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">binom0=</span><span class="fu">dbinom</span>(count, <span class="dv">20</span>, <span class="fl">0.05</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">binom1=</span><span class="fu">dbinom</span>(count, <span class="dv">20</span>, <span class="fl">0.3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">binom2=</span><span class="fu">dbinom</span>(count, <span class="dv">20</span>, <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">binom3=</span><span class="fu">dbinom</span>(count, <span class="dv">40</span>, <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>count, <span class="at">names_to=</span><span class="st">"params"</span>, <span class="at">values_to=</span><span class="st">"freq"</span>)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Informative labels for legends</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>poisson_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lambda=1"</span>, <span class="st">"lambda=4"</span>, <span class="st">"lambda=10"</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>binomial_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"n=20, p=0.01"</span>, <span class="st">"n=20, p=0.3"</span>, <span class="st">"n=20, p=0.7"</span>, <span class="st">"n=40, p=0.3"</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>poisson_dist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bin_pois_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(params, <span class="st">"^pois"</span>)), <span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">color=</span>params)) <span class="sc">+</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>freq), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>freq)) <span class="sc">+</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"counts/rate"</span>) <span class="sc">+</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Poisson distributions"</span>) <span class="sc">+</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span>poisson_labels) <span class="sc">+</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio=</span><span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>binomial_dist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bin_pois_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(params, <span class="st">"^binom"</span>)), <span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">color=</span>params)) <span class="sc">+</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>freq), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>freq)) <span class="sc">+</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"successes"</span>) <span class="sc">+</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Binomial distributions"</span>) <span class="sc">+</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span>binomial_labels) <span class="sc">+</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio=</span><span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="some-statistical-concepts" class="level1">
<h1>Some Statistical Concepts</h1>
<div class="notes">
<p>Before we get into the detail and fun of calculating appropriate group sizes for your experiments, we’re going to refresh some relevant statistical concepts.</p>
<p>I know many biologists chose biology to get away from maths and stats, but the sad reality for those people is that being a scientist demands competence in this area. You will not be able to avoid this if you want to make a career out of research.</p>
</div>
<section id="random-variables" class="level2">
<h2 class="anchored" data-anchor-id="random-variables">Random variables</h2>
<p>Your experimental measurements are <em>random variables</em></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>This does not mean that your measurements are entirely random numbers</strong></p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Random variables are values whose range is <em>subject to some element of chance</em>, e.g.&nbsp;variation between individuals</p>
<ul>
<li>Tail length (e.g.&nbsp;timing of developmental signals, distribution of nutrients)</li>
<li>Blood concentrations (e.g.&nbsp;circulatory heterogeneity, transient measurement differences)</li>
<li>Survival time (e.g.&nbsp;determining point of death)</li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li>When you take a measurement - tail length, concentration of something in blood, survival time, whatever - you are recording the value of a <em>random variable</em>
<ul>
<li><strong>This doesn’t mean that the number is chosen randomly</strong></li>
</ul></li>
<li>What it means is that the number is subject to the influence of some kind of random variation
<ul>
<li>So tail length might be partially determined by variations in influences on overall growth of an individual (like nutrition), genetic propensity, and some random redistribution of nutrients within the individual or random timing of developmental signals</li>
<li>Blood concentration might not be entirely uniform, so the measurement is subject to random variations throughout the circulatory system, or transient effects on how you measure the concentration</li>
<li>Survival time might not be measured 100% accurately - it can difficult to measure the point of death exactly, so there may be some random variation around the actual time</li>
</ul></li>
<li>There are numerous ways that random effects (“noise”) can impinge on the “signal” we’re trying to measure</li>
</ul>
</div>
</section>
<section id="probability-distributions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="probability-distributions">Probability distributions</h2>
<p>The probability distribution of a random variable <span class="math inline">\(z\)</span> (e.g.&nbsp;what you measure in an experiment) takes on some range of values<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="callout callout-style-default callout-tip callout-titled" title="The mean of the distribution of $z$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>The mean of the distribution of <span class="math inline">\(z\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The <em>mean</em> (aka <em>expected value</em> or <em>expectation</em>) is the average of all the values in <span class="math inline">\(z\)</span>
<ul>
<li>Equivalently: the <em>mean</em> is the value that is obtained <strong>on average</strong> from a random sample from the distribution</li>
</ul></li>
<li>Written as <span class="math inline">\(\mu_{z}\)</span> or <span class="math inline">\(E(z)\)</span></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="The variance of a distribution of $z$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>The variance of a distribution of <span class="math inline">\(z\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The <em>variance</em> of the distribution of <span class="math inline">\(z\)</span> represents the <em>expected</em> mean squared difference from the mean <span class="math inline">\(\mu_z\)</span> (or <span class="math inline">\(E(z)\)</span>) of a random sample from the distribution.
<ul>
<li><span class="math inline">\(\textrm{variance} = E((z - \mu_z)^2)\)</span></li>
</ul></li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li>A probability distribution describes the range of values that a random variable - let’s call it <span class="math inline">\(z\)</span> - takes.
<ul>
<li>So if you’re measuring tail length, and that’s “constant” for a population, but under the influence of the random variation in how much nutrition an individual can get, the distribution is representing that random effect around the “constant” value.</li>
<li>In more traditional statistical terms, you can think of <span class="math inline">\(z\)</span> being a single ball drawn from a bag containing an infinite number of balls, each ball with a number written on it</li>
</ul></li>
<li>Probability distributions can describe many measures, including
<ul>
<li>heights of men, incomes of women, political party preference, and so on</li>
</ul></li>
<li>The <em>mean</em> of a probability distribution - its <em>expected value</em> or <em>expectation</em> - is the average of all numbers in the distribution
<ul>
<li>There may be an infinite amount of numbers in the dataset (in principle), and there is an equivalent definition: the <em>mean</em> is the value obtained <em>on average</em> in a random sample taken from the distribution</li>
</ul></li>
<li>The <em>variance</em> of a probability distribution expresses how much the individual values might differ from that mean.
<ul>
<li>Variance is defined as the <em>mean</em> of the <strong>square of the difference between each individual value in the distribution and the mean of the distribution</strong></li>
<li>So, for each ball we draw from the bag, we treat the number as <span class="math inline">\(z\)</span> and calculate the <em>sum of squares of differences from the mean</em> - this is the variance.</li>
</ul></li>
</ul>
</div>
</section>
<section id="understanding-variance" class="level2">
<h2 class="anchored" data-anchor-id="understanding-variance">Understanding variance</h2>
<div class="callout callout-style-default callout-caution callout-titled" title="A distribution where all values of $z$ are the same">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>A distribution where all values of <span class="math inline">\(z\)</span> are the same
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Every single value in the distribution (<span class="math inline">\(z\)</span>) is also the mean value (<span class="math inline">\(\mu_z\)</span>), therefore</li>
</ul>
<p><span class="math display">\[z = \mu_z \implies z - \mu_z = 0 \implies (z - \mu_z)^2 = 0\]</span> <span class="math display">\[\textrm{variance} = E((z - \mu_z)^2) = E(0^2) = 0\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="All other distributions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>All other distributions
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <strong>every</strong> other distribution, there are some values of <span class="math inline">\(z\)</span> that differ so, for at least some values of <span class="math inline">\(z\)</span></p>
<p><span class="math display">\[z \neq \mu_z \implies  z - \mu_z \neq 0 \implies (z - \mu_z)^2 \gt 0 \]</span> <span class="math display">\[\implies \textrm{variance} = E((z - \mu_z)^2) \gt 0 \]</span></p>
</div>
</div>
<div class="notes">
<ul>
<li><p>To get some intuition about the idea of variance, imagine that you have a set of values <span class="math inline">\(z\)</span> that are all the same, so there’s no randomness</p>
<ul>
<li>So you have a bag of balls, and all the balls in the bag have the number three on them, say</li>
</ul></li>
<li><p>If the value are all the same, then they all have the same value as the <em>mean</em> of the distribution, and <span class="math inline">\(z - \mu_z = 0\)</span></p></li>
<li><p>This means that, for all <span class="math inline">\(z\)</span>, <span class="math inline">\((z - \mu_z)^2\)</span> is also zero, and the variance is zero.</p></li>
<li><p>But if any value of <span class="math inline">\(z\)</span> is different then, for at least that value, <span class="math inline">\(z - \mu_z \neq 0\)</span>, so the square of that value is greater than zero. It follows that the variance must then be greater than zero: <span class="math inline">\(E((z - \mu_z)^2) \gt 0\)</span></p></li>
<li><p><strong>In any dataset you meet, you are unlikely to have all values be identical, and so the variance is going to take a positive value</strong></p>
<ul>
<li><strong>All measurements you make will have variability in them! This variability must be accounted for.</strong></li>
</ul></li>
</ul>
</div>
</section>
<section id="standard-deviation" class="level2">
<h2 class="anchored" data-anchor-id="standard-deviation">Standard deviation</h2>
<div class="callout callout-style-default callout-warning callout-titled" title="_Standard deviation_ is the square root of the variance">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span><em>Standard deviation</em> is the square root of the variance
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\textrm{standard deviation} = \sigma_z = \sqrt{\textrm{variance}} = \sqrt{E((z - \mu_z)^2)} \]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Advantages">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Advantages
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The <em>standard deviation</em> (unlike variance) takes values on the same scale as the original distribution
<ul>
<li>Standard deviation is a more “natural-seeming” interpretation of variation</li>
</ul></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can calculate <em>mean</em>, <em>variance</em>, and <em>standard deviation</em> for <strong>any</strong> probability distribution.</p>
</div>
</div>
<div class="notes">
<ul>
<li><p>You are probably more familiar with the <em>standard deviation</em> of a distribution.</p></li>
<li><p>The standard deviation is on the same kind of scale as the values of the distribution, which makes this an easier value to interpret than the variance</p></li>
<li><p>While we can calculate the mean, variance and standard deviation for <em>any</em> distribution, this does <strong>not</strong> mean that they are equally informative for all distributions</p></li>
<li><p>Let’s look at some examples</p></li>
</ul>
</div>
</section>
<section id="normal-distribution-1" class="level2">
<h2 class="anchored" data-anchor-id="normal-distribution-1">Normal Distribution 1</h2>
<p><span class="math display">\[ z \sim \textrm{normal}(\mu_z, \sigma_z) \]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We only need to know the mean and standard deviation to define a unique normal distribution</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Measurements of variables whose value is the sum of many small, independent, additive factors may follow a normal distribution</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>There is no reason to expect that a random variable representing direct measurements in the world will be normally distributed!</strong></p>
</div>
</div>
<div class="notes">
<ul>
<li>You may see the normal distribution written like this, as “<span class="math inline">\(z\)</span> is distributed as the Normal distribution with mean <span class="math inline">\(\mu_z\)</span> and standard deviation <span class="math inline">\(\sigma_z\)</span>.”
<ul>
<li>We only need to know the mean and standard deviation to define a unique normal distribution</li>
</ul></li>
<li>Values we measure in the real world should follow an approximate normal distribution if each measured value is the sum of many small, independent, additive factors
<ul>
<li>This is a consequence of the Central Limit Theorem</li>
<li>Many real-world variables do follow normal distributions</li>
</ul></li>
<li><strong>But there is no reason to expect that any random variable representing any direct measurement you make will have this property, or follow a normal distribution</strong>
<ul>
<li>This is especially the case if there is a large factor affecting variation of the variable (e.g.&nbsp;sex)</li>
</ul></li>
</ul>
</div>
</section>
<section id="normal-distribution-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="normal-distribution-2">Normal Distribution 2</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot normal curves for of height counts for men and women</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example from https://avehtari.github.io/ROS-Examples/CentralLimitTheorem/heightweight.html</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(heights_f, heights_m, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-distributions_files/figure-html/norm_density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>For a normal distribution, the mean value is the value at the peak of the curve</li>
<li>The curve is symmetrical, so standard deviation describes variability equally well on both sides of the mean</li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li><p>As an example, we can look at some real data, the heights of men and women in the US.</p>
<ul>
<li>Here we have counts of individuals whose heights are measured to the nearest inch - they’re shown as counts in the histograms</li>
</ul></li>
<li><p>These are two different <em>random variables</em>: one for men, one for women</p></li>
<li><p>For both distributions, we can calculate a mean, and a standard deviation (or variance)</p>
<ul>
<li>Therefore we can calculate a normal distribution representing both men’s and women’s heights (orange curve)</li>
<li>We calculate the mean heights for men and women (63.7 and 69.1 inches), and also the standard deviations (2.7 and 2.9 inches)</li>
</ul></li>
<li><p>The distributions of heights for each sex, separately, follow an approximate normal distribution</p></li>
<li><p>For a normal distribution, the mean value is the value at the peak of the curve</p></li>
<li><p>The curve is symmetrical, so the standard deviation describes variability equally well on both sides of the mean</p></li>
</ul>
</div>
</section>
<section id="non-normal-distribution-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="non-normal-distribution-3">(Non-)Normal Distribution 3</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot normal curves for of height counts for all us_adults</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example from https://avehtari.github.io/ROS-Examples/CentralLimitTheorem/heightweight.html</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>heights_adults</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-distributions_files/figure-html/all_heights-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Here, the mean may not be the same value as the peak of the curve (i.e.&nbsp;the <em>mode</em>)</li>
<li>The curve is asymmetrical, so standard deviation does not describe variation equally well on either side of the mean</li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li><p>By contrast, the distribution of heights of <em>all</em> adults in the US is not close to a normal curve</p></li>
<li><p>This is because there is an extraneous factor, <strong>sex</strong>, that represents much of the total variation in values</p></li>
<li><p>Here, the mean may not be the same value as the peak of the curve (i.e.&nbsp;the <em>mode</em>)</p></li>
<li><p>The curve is asymmetrical, so standard deviation does not describe variation equally well on either side of the mean</p></li>
<li><p>Data you receive may not be normally distributed</p>
<ul>
<li>(possibly even most of the data you receive!)</li>
</ul></li>
</ul>
</div>
</section>
<section id="binomial-distribution-1" class="level2">
<h2 class="anchored" data-anchor-id="binomial-distribution-1">Binomial Distribution 1</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Suppose you’re taking shots in basketball</p>
<ul>
<li>how many shots?</li>
<li>how likely are you to score?</li>
<li>what is the distribution of the number of successful shots?</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>This kind of process generates a random variable approximating a probability distribution called a <strong>binomial distribution</strong>.</p>
<p>It is different from a normal distribution.</p>
</div>
</div>
</div><div class="column" style="width:40%;">
<p><img src="assets/images/basketball.png" class="img-fluid"></p>
</div>
</div>
<div class="notes">
<ul>
<li><p>I mentioned earlier that a normal distribution arises when a process produces the a sum of many independent random variables.</p>
<ul>
<li><strong>In general statistical distributions are idealised repreentations of the outcomes of distinct kinds of real-world processes</strong></li>
</ul></li>
<li><p>Suppose that instead of measuring height, weight, concentration or something like that, you’re measuring <em>event outcomes</em></p>
<ul>
<li>These are not the result of summing independent random variables, and do not follow a normal distribution</li>
</ul></li>
<li><p>If you take a bunch of basketball shots (equivalent to our experimental events), each one has some probability of succeeding</p></li>
<li><p>The number of successful shots is going to depend on the number of shots you take, and how likely you are to score</p>
<ul>
<li>Michael Jordan is much more likely to score any individual attempt than I am</li>
</ul></li>
<li><p>The number of successful shots is a random variable with a probability distribution</p></li>
<li><p>This kind of process generates a probability distribution that approximates the <strong>binomial distribution</strong></p>
<ul>
<li>It’s the same one you get for coin tosses (or any yes/no process)</li>
</ul></li>
<li><p>It is different from a normal distribution</p>
<ul>
<li>If your underlying biological process resembles coin tosses or basketball shots, you need to design your experiment and analysis to be using an appropriate statistical test, such as one suitable for a binomial distribution</li>
</ul></li>
</ul>
</div>
</section>
<section id="binomial-distribution-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="binomial-distribution-2">Binomial Distribution 2</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><span class="math display">\[ z \sim \textrm{binomial}(n, p) \]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>number of shots, <span class="math inline">\(n = 20\)</span>, probability of scoring, <span class="math inline">\(p = 0.3\)</span></li>
</ul>
<p><span class="math display">\[z \sim \textrm{binomial}(20, 0.3) \]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="mean and sd">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>mean and sd
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[ \textrm{mean} = n \times p \]</span> <span class="math display">\[ \textrm{sd} = \sqrt{n \times p \times (1-p)}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Design note">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Design note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You need to design your experiments and analyses to reflect the appropriate process/probability distributions of your data. E.g., does <span class="math inline">\(p\)</span> differ between two conditions?</p>
</div>
</div>
</div><div class="column" style="width:40%;">
<p><img src="assets/images/basketball.png" class="img-fluid"></p>
</div>
</div>
<div class="notes">
<ul>
<li>We write the definition of a binomial distribution as <span class="math inline">\(z \sim \textrm{binomial}(n, p)\)</span>
<ul>
<li>Unique distributions are defined by combinations of the number of events, and the probability with which each event occurs</li>
</ul></li>
<li>Imagine you took 20 shots at basketball, and had a probability of 0.3 of scoring any one shot</li>
<li>The distribution of shots you scored would follow a binomial distribution with <span class="math inline">\(n=20\)</span> and <span class="math inline">\(p=0.3\)</span></li>
<li>You’d expect to score, on average, <span class="math inline">\(20 \times 0.3 = 6\)</span> times</li>
<li>I’m not going to derive the variance and standard deviation expression
<ul>
<li>The standard deviation we’d expect would be <span class="math inline">\(\sqrt{20 \times 0.3 \times (1 - 0.3)} = \sqrt{6 \times (0.7)} = \sqrt{4.2} = 2.05\)</span></li>
<li>So you’d expect to score about 2 to 10 shots, most of the time</li>
</ul></li>
</ul>
</div>
</section>
<section id="poisson-distribution-1" class="level2">
<h2 class="anchored" data-anchor-id="poisson-distribution-1">Poisson distribution 1</h2>
<div class="columns">
<div class="column" style="width:60%;">
<blockquote class="blockquote">
<p>In prior experiments the frequency of calcium events in WKY was 3.8 <span class="math inline">\(\pm\)</span> 1.1 events/field/min compared to 18.9 <span class="math inline">\(\pm\)</span> 7.1 in SHR</p>
</blockquote>
<div class="callout callout-style-default callout-warning callout-titled" title="This is not normal (or binomial)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>This is not normal (or binomial)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Something that happens a certain number of times in a fixed interval generates a <em>Poisson distribution</em>.</p>
<p>This is different from a normal or binomial distribution.</p>
</div>
</div>
</div><div class="column" style="width:40%;">
<p><img src="assets/images/calcium_events.png" class="img-fluid"></p>
</div>
</div>
<div class="notes">
<ul>
<li>Suppose you run an experiment to measure calcium spiking events in tissue for two different mouse lines, WKY and SHR
<ul>
<li>You count the number of times the calcium spikes in a minute, in your field of view</li>
</ul></li>
<li>This data is <em>rate</em> data
<ul>
<li>A count of events per unit (here, unit time and unit area) <em>interval</em></li>
</ul></li>
<li>The idealised representation of data generated by this process is a <strong>Poisson distribution</strong>
<ul>
<li>This differs from a normal or binomial distribution</li>
</ul></li>
</ul>
</div>
</section>
<section id="poisson-distribution-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="poisson-distribution-2">Poisson distribution 2</h2>
<p><span class="math display">\[z \sim \textrm{poisson}(\lambda)\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Poisson distribution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Poisson distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[ \textrm{mean} = \lambda \]</span> <span class="math display">\[ \textrm{sd} = \sqrt{\lambda} \]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Expectation ($\lambda$)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Expectation (<span class="math inline">\(\lambda\)</span>)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Only one parameter is provided, <span class="math inline">\(\lambda\)</span>: the rate with which the measured event happens</p></li>
<li><p>Suppose a county has population 100,000, and average rate of cancer is 45.2mn people each year</p></li>
</ul>
<p><span class="math display">\[z \sim \textrm{poisson}(45,200,000/100,000) = \textrm{poisson}(4.52) \]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Design note">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Design note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You need to design your experiments and analyses to reflect the appropriate process/probability distributions of your data</p>
<ul>
<li>E.g., does <span class="math inline">\(\lambda\)</span> differ between two conditions?</li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li><p>Count or rate data, i.e.&nbsp;discrete events that happen in a given duration, volume or area, generate the <em>Poisson distribution</em></p>
<ul>
<li>Unique Poisson distributions are described as <span class="math inline">\(z \sim \textrm{poisson}(\lambda)\)</span>, defined only by the <em>expected value</em> <span class="math inline">\(\lambda\)</span></li>
</ul></li>
<li><p>Examples of this kind of data include the number of cases of cancer in a county, the number of red cars you see on your journey into university, or the number of calcium concentration spikes you count in a survey period.</p></li>
<li><p>The distribution takes only one parameter: the <strong>expectation</strong>, lambda</p></li>
<li><p>If your experiment generates data of this kind, you need to use a test that distinguishes between the value of lambda between the two conditions</p></li>
</ul>
</div>
</section>
<section id="binomial-and-poisson-distributions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="binomial-and-poisson-distributions">Binomial and Poisson distributions</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(binomial_dist, poisson_dist, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-distributions_files/figure-html/binomial_poisson-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Some important features">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Some important features
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>All measured values (and <span class="math inline">\(n\)</span>) are positive whole numbers or zero; <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(p\)</span> may be positive <em>real numbers</em> or zero</li>
<li>The distributions may not be unimodal</li>
<li>The mean is not always the peak value (<em>mode</em>)</li>
<li>The distributions are not always symmetrical (so sd may not describe variation equally either side of the mean)</li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li>Binomial and poisson distributions are related, and they look like this for the indicated parameter settings
<ul>
<li>The distributions are only defined at whole values - the lines are to guide your eye</li>
</ul></li>
<li>For binomial distributions the expected successes shift rightwards as the probability of success increases, and as the number of attempts increases
<ul>
<li>More attempts also increases the variance of the distribution</li>
</ul></li>
<li>For poisson distributions, the peak of the distribution shifts rightwards as the expectation increases in value
<ul>
<li>The distribution also becomes more symmetric</li>
</ul></li>
<li><strong>In both cases, all values - counts/rates or successes - are positive whole numbers</strong>
<ul>
<li>(though <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(p\)</span> can be real values)</li>
</ul></li>
</ul>
</div>
</section>
<section id="distributions-in-practice" class="level2">
<h2 class="anchored" data-anchor-id="distributions-in-practice">Distributions in Practice</h2>
<div class="callout callout-style-default callout-caution callout-titled" title="Distributions are starting points">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Distributions are starting points
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Distributions arise from and represent distinct <em>generation processes</em> (relate this to your biological system)
<ul>
<li>Normal distributions are generated by sums, differences, and averages</li>
<li>Poisson distributions are generated by counts (per unit interval)</li>
<li>Binomial distributions are generated by success/failure outcomes</li>
</ul></li>
<li><strong>Design experiments with analyses that reflect these processes</strong></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>All statistical distributions are <strong>idealisations that ignore many features of real data</strong></li>
<li>No real world data should be expected to exactly match <em>any</em> statistical distribution</li>
<li>Poisson models tend to need adjustment for <em>overdispersion</em></li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li>The different distributions we’ve looked at arise from distinct generation processes that have parallels in the real world
<ul>
<li>Normal distributions arise when independent values are summed, or we take differences or averages of them</li>
<li>Poisson distributions arise from counts, or rates (i.e.&nbsp;counts per unit)</li>
<li>Binomial distributions arise from success/failure outcomes like tossing a coin</li>
</ul></li>
<li>We need to take care though, as these distributions are idealised outcomes from those processes</li>
<li>In the real world there are many other influences that cause collected data to deviate from these idealisations
<ul>
<li>There is <strong>no reason</strong> to expect real world data to exactly match <em>any</em> statistical distribution</li>
<li>Though there are some principles: we ought not to use a normal distribution to model count data (as the normal distribution can drop below zero where counts cannot)</li>
</ul></li>
<li><strong>In general we <em>approximate</em> our real data with these idealised distributions in order to obtain more statistical power</strong></li>
</ul>
</div>
</section>
<section id="normal-distribution-redux" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="normal-distribution-redux">Normal Distribution Redux</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal distribution with standard deviation masses indicated</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example from https://avehtari.github.io/ROS-Examples/CentralLimitTheorem/heightweight.html</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>), <span class="at">tck=</span><span class="sc">-</span>.<span class="dv">01</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), <span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">main=</span><span class="st">"normal distribution, mean=0 sd=1"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>, <span class="at">yaxt=</span><span class="st">"n"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"-3"</span>, <span class="st">"-2"</span>, <span class="st">"-1"</span>,  <span class="st">"0"</span>,  <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">""</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.5</span>, .<span class="dv">5</span>, <span class="dv">0</span>), <span class="at">cex.axis=</span><span class="fl">1.2</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gray70"</span>, <span class="st">"gray50"</span>, <span class="st">"gray30"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span>i, i, .<span class="dv">01</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(grid, i, <span class="sc">-</span>i), <span class="fu">c</span>(<span class="fu">dnorm</span>(grid), <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">col=</span>colors[i])</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, .<span class="dv">35</span><span class="sc">*</span><span class="fu">dnorm</span>(<span class="dv">0</span>), <span class="st">"68%"</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.5</span>, .<span class="dv">3</span><span class="sc">*</span><span class="fu">dnorm</span>(<span class="fl">1.5</span>), <span class="st">"13.5%"</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, .<span class="dv">3</span><span class="sc">*</span><span class="fu">dnorm</span>(<span class="fl">1.5</span>), <span class="st">"13.5%"</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-distributions_files/figure-html/normal-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Probability mass">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Probability mass
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>approximately 50% of the distribution lies in the range <span class="math inline">\(\mu \pm 0.68\sigma\)</span></li>
<li>approximately 68% of the distribution lies in the range <span class="math inline">\(\mu \pm \sigma\)</span></li>
<li>approximately 95% of the distribution lies in the range <span class="math inline">\(\mu \pm 2\sigma\)</span></li>
<li>approximately 99.7% of the distribution lies in the range <span class="math inline">\(\mu \pm 3\sigma\)</span></li>
</ul>
</div>
</div>
<div class="notes">
<ul>
<li>An intuition worth developing is how much of a (normal) distribution lies within some range of the mean
<ul>
<li>This is going to be useful when thinking about <em>p</em>-values and hypothesis tests</li>
</ul></li>
<li>Here we have a normal distribution with a mean of zero and a standard deviation of 1, so the values on the x-axis represent standard deviations from the mean.
<ul>
<li>It’s a normal distribution, so symmetrical about the mean</li>
<li>The area contained within the +1 and -1 standard deviation limits account for ≈68% of the total area of the distribution</li>
<li>The area contained within the +2 and -2 standard deviation limits account for ≈95% of the total area of the distribution</li>
</ul></li>
<li>It will be useful to have this intuition for the next section</li>
</ul>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Here we are considering a populations of an infinite number of measurements of <span class="math inline">\(z\)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sipbs-compbiol\.github\.io\/MP968-Workshop_Experimental_Design_Slides\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>