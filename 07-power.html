<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>power</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8fd1faf6fd93e4e6d207ae0f9db51d78.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
</div>
<section id="statistical-power" class="level1">
<h1>Statistical power</h1>
<section id="statistical-power-1" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-1">Statistical power</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Statistical <em>power</em> is defined as the probability, <strong>before a study is performed</strong>, that a particular comparison will achieve “statistical significance” at some predetermined level (e.g.&nbsp;<span class="math inline">\(P &lt; 0.05\)</span>) <strong>given an assumed true effect size</strong>.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="The process">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>The process
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Hypothesise an appropriate effect size (e.g.&nbsp;what effect will improve health?)</li>
<li>Determine the <span class="math inline">\(p\)</span>-value threshold you consider “statistically significant”</li>
<li>Make reasoned assumptions about the variation in the data (e.g.&nbsp;what distribution? what variance?)</li>
<li>Choose a sample size</li>
<li>Use probability calculations to determine the chance that your observed <span class="math inline">\(p\)</span>-value will be below the threshold (accept the null hypothesis) for the hypothesised effect size</li>
</ol>
</div>
</div>
</section>
<section id="effect-sizes" class="level2">
<h2 class="anchored" data-anchor-id="effect-sizes">Effect sizes</h2>
<div class="callout callout-style-default callout-warning callout-titled" title="Power analysis depends on an assumed effect size">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Power analysis depends on an assumed effect size
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The true effect size is almost never known ahead of time
<ul>
<li>Determining the effect size is usually why we’re doing the study</li>
</ul></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="How to choose effect sizes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>How to choose effect sizes
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Try a range of values consistent with relevant literature</li>
<li>Determine what value would be of practical interest (e.g.&nbsp;improvement in outcomes of 10%)</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="How _not_ to choose effect size">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>How <em>not</em> to choose effect size
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>DO NOT USE AN ESTIMATE FROM A SINGLE NOISY STUDY!</strong>
<ul>
<li>Noisy studies suffer from <em>The Winner’s Curse</em></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="the-winners-curse-1" class="level2">
<h2 class="anchored" data-anchor-id="the-winners-curse-1">The Winner’s Curse 1</h2>
<div class="callout callout-style-default callout-caution callout-titled" title="A low-powered pilot study">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>A low-powered pilot study
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Suppose we ran a small pilot study with only a few individuals</li>
<li>The study, by design, has <em>low statistical power</em>
<ul>
<li>The variance of the data is relatively large, compared to the true effect size</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shaded normal curve for the Winner's curse - a low-powered pilot study</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># True effect size is 2%, SE=8</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shaded_normal</span>(<span class="at">mu=</span><span class="dv">2</span>, <span class="at">sd=</span><span class="dv">8</span>, <span class="at">zstart=</span><span class="fl">0.025</span>, <span class="at">zend=</span><span class="fl">0.93</span>, <span class="at">xlabels=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_x_marker</span>(<span class="at">x=</span><span class="dv">2</span>, <span class="at">y=</span><span class="fl">0.06</span>, <span class="at">linecolor=</span><span class="st">"purple"</span>, <span class="at">textcolor=</span><span class="st">"purple"</span>, <span class="at">label=</span><span class="st">"true effect size"</span>, <span class="at">textoffset=</span><span class="fl">0.002</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_x_marker</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fl">0.05</span>, <span class="at">linecolor=</span><span class="st">"darkorange"</span>, <span class="at">textcolor=</span><span class="st">"darkorange"</span>, <span class="at">label=</span><span class="st">"null effect size"</span>, <span class="at">textoffset=</span><span class="fl">0.002</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated effect size (percent)"</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07-power_files/figure-html/winner_1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>To see what I mean, suppose that we ran a pilot study for a treatment where the true effect size was only a two percentage point increase in the outcome, but this effect is estimated with a standard error of about eight percentage points.</p>
<ul>
<li><p>We test this against the null hypothesis that the effect size is zero</p></li>
<li><p>We set up the null hypothesis so that the result of the study is “positive”/“statistically significant” if the measured difference is more than two standard errors away from zero - i.e.&nbsp;outwith the orange shading of the curve</p></li>
<li><p><strong>Even though the actual true mean effect is 2%, the larger standard error means that there is the possibility of the measured result falling outside that central shaded area</strong></p></li>
</ul>
</div>
</section>
<section id="the-winners-curse-2" class="level2">
<h2 class="anchored" data-anchor-id="the-winners-curse-2">The Winner’s Curse 2</h2>
<div class="callout callout-style-default callout-caution callout-titled" title="You get a statistically significant result!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>You get a statistically significant result!
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>You think you won, but you lost! (The Winner’s Curse)
<ul>
<li>The estimate is either eight times <strong>too large</strong> (at least 16% instead of 2%) <em>or</em></li>
<li>The estimate <strong>has the wrong sign</strong> (a negative change instead of positive)</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shaded normal curve for the Winner's curse - a low-powered pilot study</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># True effect size is 2%, SE=8</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shaded_normal</span>(<span class="at">mu=</span><span class="dv">2</span>, <span class="at">sd=</span><span class="dv">8</span>, <span class="at">zstart=</span><span class="fl">0.025</span>, <span class="at">zend=</span><span class="fl">0.93</span>, <span class="at">xlabels=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_x_marker</span>(<span class="at">x=</span><span class="dv">2</span>, <span class="at">y=</span><span class="fl">0.06</span>, <span class="at">linecolor=</span><span class="st">"purple"</span>, <span class="at">textcolor=</span><span class="st">"purple"</span>, <span class="at">label=</span><span class="st">"true effect size"</span>, <span class="at">textoffset=</span><span class="fl">0.002</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_x_marker</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fl">0.05</span>, <span class="at">linecolor=</span><span class="st">"darkorange"</span>, <span class="at">textcolor=</span><span class="st">"darkorange"</span>, <span class="at">label=</span><span class="st">"null effect size"</span>, <span class="at">textoffset=</span><span class="fl">0.002</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_normal</span>(<span class="at">mu=</span><span class="dv">2</span>, <span class="at">sd=</span><span class="dv">8</span>, <span class="at">zstart=</span><span class="fl">0.93</span>, <span class="at">zend=</span><span class="dv">1</span>, <span class="at">xlabels=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">"plum4"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_normal</span>(<span class="at">mu=</span><span class="dv">2</span>, <span class="at">sd=</span><span class="dv">8</span>, <span class="at">zstart=</span><span class="fl">0.0</span>, <span class="at">zend=</span><span class="fl">0.025</span>, <span class="at">xlabels=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">"plum4"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">20</span>, <span class="at">y=</span><span class="fl">0.02</span>, <span class="at">color=</span><span class="st">"purple"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">c</span>(<span class="st">"You think you won </span><span class="sc">\n</span><span class="st"> but your estimate </span><span class="sc">\n</span><span class="st"> is over eight times </span><span class="sc">\n</span><span class="st"> too high! </span><span class="sc">\n</span><span class="st"> (≈7%) "</span>)) <span class="sc">+</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="sc">-</span><span class="dv">18</span>, <span class="at">y=</span><span class="fl">0.02</span>, <span class="at">color=</span><span class="st">"purple"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">c</span>(<span class="st">"You think you won </span><span class="sc">\n</span><span class="st"> but your estimate </span><span class="sc">\n</span><span class="st"> has the wrong sign! </span><span class="sc">\n</span><span class="st"> (≈2.5%)"</span>)) <span class="sc">+</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated effect size (percent)"</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 400 rows containing non-finite outside the scale range
(`stat_align()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07-power_files/figure-html/winner_2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>In this low-powered experiment, any “statistically significant” result must fall into one of the dark purple sections of the curve at the extremes
<ul>
<li>The left-most 2.5% of outcomes or</li>
<li>The right-most 7% of outcomes</li>
</ul></li>
<li>The problem is this:
<ul>
<li>“Statistically significant” results on the right hand side overestimate the size of the true effect by at least eight times (minimum value 16%)</li>
<li>“Statistically significant” results on the right hand side indicate that the effect is <em>negative</em> - a reduction in effect, when the true effect is small but positive</li>
</ul></li>
</ul>
</div>
</section>
<section id="the-winners-curse-3" class="level2">
<h2 class="anchored" data-anchor-id="the-winners-curse-3">The Winner’s Curse 3</h2>
<div class="callout callout-style-default callout-important callout-titled" title="The trap">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>The trap
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Any apparent success of low-powered studies masks larger failure</strong></p>
<p>When <em>signal</em> (effect size) is low and <em>noise</em> (standard error) is high, “statistically significant” results are likely to be wrong.</p>
<p><strong>Low-power studies tend not to replicate well</strong></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Low-power studies have essentially no chance of providing useful information</strong></p>
<p>We can say this even before data are collected</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-empty-content callout-titled" title="Published results tend to be overestimates">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Published results tend to be overestimates
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="statistical-power-and-ethics" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-and-ethics">Statistical power and ethics</h2>
<div class="callout callout-style-default callout-important callout-titled" title="It is unethical to under-power animal studies">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>It is unethical to under-power animal studies
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p>Under-powered in vivo experiments waste time and resources, lead to unnecessary animal suffering and result in erroneous biological conclusions (NC3Rs Experimental Design Assistant guide)</p>
</blockquote>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="It is unethical to over-power animal studies">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>It is unethical to over-power animal studies
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p>Ethically, when working with animals we need to conduct a harm–benefit analysis to ensure the animal use is justified for the scientific gain. Experiments should be robust, not use more or fewer animals than necessary, and truly add to the knowledge base of science (<span class="citation" data-cites="Karp2021-lc">@Karp2021-lc</span>)</p>
</blockquote>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-empty-content callout-titled" title="So how should we _appropriately_ power animal studies?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>So how should we <em>appropriately</em> power animal studies?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="statistical-power-and-error-1" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-and-error-1">Statistical power and error 1</h2>
<p>We often refer to two kinds of statistical error</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Type I Error ($\alpha$)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Type I Error (<span class="math inline">\(\alpha\)</span>)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Type I error is <em>the probability of <strong>rejecting</strong> a null hypothesis, when the null hypothesis is <strong>true</strong></em>
<ul>
<li>Also known as a “false positive error”</li>
</ul></li>
<li>Represented by the Greek letter <span class="math inline">\(\alpha\)</span></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Type II Error ($\beta$)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Type II Error (<span class="math inline">\(\beta\)</span>)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Type I error is <em>the probability of <strong>accepting</strong> a null hypothesis, when the null hypothesis is <strong>false</strong></em>
<ul>
<li>Also known as a “false negative error”</li>
</ul></li>
<li>Represented by the Greek letter <span class="math inline">\(\beta\)</span></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-empty-content callout-titled" title="Statistical power is $1 - \beta$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Statistical power is <span class="math inline">\(1 - \beta\)</span>
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="statistical-power-and-error-2" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-and-error-2">Statistical power and error 2</h2>
<p>Statistical power needs context: the expected error rates of the experiment at a given effect size, e.g.</p>
<blockquote class="blockquote">
<p>The experiment has 80% power at <span class="math inline">\(\alpha = 0.05\)</span> for an effect size of 2mM/L</p>
</blockquote>
<div class="callout callout-style-default callout-tip callout-titled" title="How to read this">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>How to read this
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>“an effect size of 2mM/L”: we are aiming to detect an effect of at least 2mM/L (e.g.&nbsp;blood glucose concentration)</li>
<li>“<span class="math inline">\(\alpha = 0.05\)</span>”: we are using a significance test threshold (<span class="math inline">\(\alpha\)</span>, <em>type I error rate</em>) of <span class="math inline">\(P &lt; 0.05\)</span></li>
<li>“80% power”: <strong>we expect the study to report a significant effect, <em>where one truly exists</em>, 80% of the time</strong></li>
</ul>
</div>
</div>
</section>
<section id="statistical-power-and-error-3" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-and-error-3">Statistical power and error 3</h2>
<blockquote class="blockquote">
<p>The experiment has 80% power at <span class="math inline">\(\alpha = 0.05\)</span> for an effect size of 2mM/L</p>
</blockquote>
<div class="callout callout-style-default callout-important callout-titled" title="If the drug truly has no effect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>If the drug truly has no effect
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The test has <span class="math inline">\(\alpha = 0.05\)</span>, so we would expect to reject the null hypothesis <strong>incorrectly</strong> 5% of the time</li>
<li>If we ran the experiment 100 times, we would expect to see a result implying that the drug was effective <strong>five times</strong></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="If the drug truly has an effect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>If the drug truly has an effect
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The test has predicted power <span class="math inline">\(1 - \beta = 0.8\)</span>, so the type II error rate <span class="math inline">\(\beta = 0.2\)</span> and we would expect to accept the null hypothesis <strong>incorrectly</strong> 20% of the time</li>
<li>If we ran the experiment 100 times, we would expect to see a result implying that the drug was effective <strong>eighty times</strong></li>
</ul>
</div>
</div>
</section>
<section id="statistical-power-and-sample-size-1" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-and-sample-size-1">Statistical power and sample size 1</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="What we need, to calculate appropriate sample size">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>What we need, to calculate appropriate sample size
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>An <strong>acceptable false positive rate</strong> (type I error, <span class="math inline">\(\alpha\)</span>)</li>
<li>An <strong>acceptable false negative rate</strong> (type II error, <span class="math inline">\(\beta\)</span>)
<ul>
<li>This is equivalent to knowing the <em>target statistical power</em> (<span class="math inline">\(1 - \beta\)</span>)</li>
</ul></li>
<li>The expected <strong>effect size</strong> and <strong>variance</strong></li>
<li>The <strong>statistical test</strong> being performed</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>We need this information to calculate an appropriate, <em>ethical</em> sample size</p>
</div>
</div>
</section>
<section id="statistical-power-and-sample-size-2" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-and-sample-size-2">Statistical power and sample size 2</h2>
<div class="callout callout-style-default callout-important callout-titled" title="Typical funders' requirements">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Typical funders’ requirements
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>False positive rate <span class="math inline">\(\alpha = 0.05\)</span></p></li>
<li><p>Power <span class="math inline">\(1 - \beta = 0.8\)</span> (80% power)</p></li>
<li><p>These are only a starting point - other values may be more appropriate depending on circumstance</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Under experimenter control">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Under experimenter control
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Effect size and variance</li>
<li>The appropriate statistical approach</li>
</ul>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sipbs-compbiol\.github\.io\/MP968-Workshop_Experimental_Design_Slides\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>